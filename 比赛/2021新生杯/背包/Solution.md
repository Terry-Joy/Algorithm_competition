# TLE爱奖牌(题解)

本场防难度较大(?)的题, 学过背包的同学应该很容易就看出这是个非常裸的$01$背包模型，我们有一个经典的$dp$转移，$f[i][j]$表示前$i$件物品选的总价值为$j$时的方案，转移较为简单

+ 第$i$件物品能放进去 $(j\geq w[i])$
  +  选择不放 $f[i-1][j]$
  + 放入第$i$件物品  $f[i-1][j-w[i]]+v[i]$
  + 所以$f[i][j]=max(f[i-1][j],f[i-1][j-w[i]]+v[i])$
+ 第$i$件物品放不进去
  + $f[i][j]=f[i-1][j]$

时间复杂度是$O(nm)$, 空间复杂度经过滚动数组后是$O(m)$的。

显然，在本题都无法通过，或许模拟退火有一点机会（？）

其实我们有个比较常规的思维，考虑将当前转移到的状态，即前$i-1$个物品选完后的状态的{$背包总质量V，获得的价值W$}作为二元组存下来，对于两个二元组来说，如果其中一个$W$更大且$V$更小，是没有必要存在的。因为他必定比另一个状态更劣，我们考虑把二元组写到二维坐标系上，如下图。

<img src=".\Problem Fig. 1.png"/>

显然我们只用保留红线内从左下到右上的点，因为剩余的点对比红线内的点没有存在的意义。所以我们有一个策略，每次只保留红线这种形式的点，然后再转移，具体来说就是每次加入一个物品，对当前所有的点通过这个物品转移，转移后只保留形如红线内的点，具体的转移通过**归并排序**，每次保留按照$W$排序，$W$相同的保留$V$最大的，然后从小到大遍历点集，此外，**新的点集中只加入$V$严格大于当前点集最大值的点**，这样可以做到只遍历所有点一次，我们可以发现，红线上的点其实可以看成是上凸壳的点（因为右下方的点都无法保留），所以相当于每次加入第$i$个物品，最后相当于在2的$i$次方个点中保留上凸壳，而实际上对于随机数据来说，二维正方形随机撒点下凸包上点的期望个数是$logn$的，关于这个结论的证明及其拓展可以参考 http://link.zhihu.com/?target=https%3A//arxiv.org/pdf/1111.5340.pdf 这篇论文，所以每次转移后最多保留$logn$个点，每次加入一个新物品转移需要遍历这些点一次，又由于$n$个物品每个物品选或不选总点数是$O(2^n)$的，所以时间复杂度不会超过 $O(log^22^n)=O(n^2)$, 实际上由于归并时很难跑满，所以实际效率远低于$O(n^2)$。



