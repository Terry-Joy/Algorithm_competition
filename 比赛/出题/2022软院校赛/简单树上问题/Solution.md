显然我们需要考虑每条边的贡献，考虑从小到大加边，用并查集维护这个过程，每次通过边权为$w$的这条边合并$x$,$y$两个集合的时候，对$x$的贡献是$size[y] * w$，对$y$同理，我们可以类似线段树延迟标记的方法，在每个并查集的根上记录标记，最后再下放，注意这里被合并的集合合并需要减去另一个集合的贡献，同时为了不破坏树形结构，我们不进行路径压缩，只使用按秩合并，时间复杂度$O(mlogn)$。